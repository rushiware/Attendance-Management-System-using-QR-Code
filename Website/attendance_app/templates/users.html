{% extends 'index.html' %}  
{% load static %}

{% block title %}Users{% endblock title %}

{% block main-content %}
{% if role == "student" %}
<div class="container text-center mt-4">
    <h3 id="usr_txt">Users - Students</h3>
    <h5 class="text-success" style="text-align: right;">Total Users = <span id="total-users"></span></h5>

    <div class="mt-3" style="display: flex; justify-content: space-between;">
        <div class="row">
            <nav class="ml-3">
                <menu>
                    <menuitem id="demo1">
                        <button id="sort-btn" class="btn btn-primary dropdown-toggle">&#9778; Sort by</button>
                        <menu id="sort-menu" class="dropdown-menu">
                            <menuitem id="branch-txt" class="dropdown-item dropdown-item-hvr">
                                <span style="display: inline-block;">Branch <span style="display: inline-block; text-align: right; width: 100%">&#10148;</span></span>
                                <menu id="branch-menu" class="dropdown-menu">
                                    <menuitem class="dropdown-item dropdown-item-hvr branch-item"><a>CSE</a></menuitem>
                                    <menuitem class="dropdown-item dropdown-item-hvr branch-item"><a>IT</a></menuitem>
                                    <menuitem class="dropdown-item dropdown-item-hvr branch-item"><a>Electronics</a></menuitem>
                                    <menuitem class="dropdown-item dropdown-item-hvr branch-item"><a>Mechanical</a></menuitem>
                                    <menuitem class="dropdown-item dropdown-item-hvr branch-item"><a>Electrical</a></menuitem>
                                    <menuitem class="dropdown-item dropdown-item-hvr branch-item"><a>Civil</a></menuitem>
                                </menu>  
                            </menuitem>
                            <menuitem id="year-txt" class="dropdown-item dropdown-item-hvr">
                            <span style="display: inline-block;">Year &nbsp; &nbsp; <span style="display: inline-block; text-align: right; width: 100%">&#10148;</span></span>
                            <menu id="year-menu" class="dropdown-menu">
                                    <menuitem class="dropdown-item dropdown-item-hvr year-item"><a>FY</a></menuitem>
                                    <menuitem class="dropdown-item dropdown-item-hvr year-item"><a>SY</a></menuitem>
                                    <menuitem class="dropdown-item dropdown-item-hvr year-item"><a>TY</a></menuitem>
                                    <menuitem class="dropdown-item dropdown-item-hvr year-item"><a>LY</a></menuitem>
                                </menu>  
                            </menuitem>
                            <menuitem id="br-yr-txt" class="dropdown-item dropdown-item-hvr">
                            <span style="display: inline-block;">Branch & Year &#10148;</span>
                                <menu id="br-menu" class="dropdown-menu">
                                    <menuitem id="cse-txt" class="dropdown-item dropdown-item-hvr">
                                        <span style="display: inline-block;">CSE &nbsp; &nbsp; <span style="display: inline-block; text-align: right; width: 100%">&#10148;</span></span>
                                        <menu id="yr-menu-cse" class="dropdown-menu yr-menu">
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>FY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>SY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>TY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>LY</a></menuitem>
                                        </menu>
                                    </menuitem>
                                    <menuitem id="it-txt" class="dropdown-item dropdown-item-hvr">
                                        <span style="display: inline-block;">IT &nbsp; &nbsp; &nbsp; &nbsp;<span style="display: inline-block; text-align: right; width: 100%">&#10148;</span></span>
                                        <menu id="yr-menu-it" class="dropdown-menu yr-menu">
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>FY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>SY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>TY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>LY</a></menuitem>
                                        </menu>
                                    </menuitem>
                                    <menuitem id="eln-txt" class="dropdown-item dropdown-item-hvr">
                                        <span style="display: inline-block;">Electronics<span style="display: inline-block; text-align: right; width: 39%">&#10148;</span></span>
                                        <menu id="yr-menu-eln" class="dropdown-menu yr-menu">
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>FY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>SY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>TY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>LY</a></menuitem>
                                        </menu>
                                    </menuitem>
                                    <menuitem id="mech-txt" class="dropdown-item dropdown-item-hvr">
                                        <span style="display: inline-block;">Mechanical<span style="display: inline-block; text-align: right; width: 32%">&#10148;</span></span>
                                        <menu id="yr-menu-mech" class="dropdown-menu yr-menu">
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>FY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>SY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>TY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>LY</a></menuitem>
                                        </menu>
                                    </menuitem>
                                    <menuitem id="elec-txt" class="dropdown-item dropdown-item-hvr">
                                        <span style="display: inline-block;">Electrical<span style="display: inline-block; text-align: right; width: 61%">&#10148;</span></span>
                                        <menu id="yr-menu-elec" class="dropdown-menu yr-menu">
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>FY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>SY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>TY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>LY</a></menuitem>
                                        </menu>
                                    </menuitem>
                                    <menuitem id="cv-txt" class="dropdown-item dropdown-item-hvr">
                                        <span style="display: inline-block;">Civil &nbsp; &nbsp;<span style="display: inline-block; text-align: right; width: 100%">&#10148;</span></span>
                                        <menu id="yr-menu-cv" class="dropdown-menu yr-menu">
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>FY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>SY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>TY</a></menuitem>
                                            <menuitem class="dropdown-item branch-year-item dropdown-item-hvr"><a>LY</a></menuitem>
                                        </menu>
                                    </menuitem>
                                </menu>
                            </menuitem>
                    </menuitem>
                </menu>
            </nav>

            <div>
                <button class="btn btn-orange text-white ml-3" onclick="downloadStudPDF()">Download List <span style="font-weight: bold; transform: rotate(90deg); display: inline-block;">&#x21e5;</span></button>
            </div>
        
            <div>
                <button class="btn btn-success ml-3" id="show-all-users">Show All Users</button>
            </div>
        </div>

        <div>
            <label class="sr-only" for="inlineFormInputGroup">Search</label>
            <div class="input-group mb-2">
              <div class="input-group-prepend">
                <div class="input-group-text" style="background-color: #ffc107;">&#128269;</div>
              </div>
                <input style="border: 2px solid #ffc107;" type="text" class="form-control srch-ip" id="searchInput" placeholder="Search by anything...">
            </div>
        </div>
    </div>

    <h3 id="users-not-found" class="text-danger mt-3">No users found !!</h3>

    <div class="table-responsive" id="usr-tb-resp">
        <table id="usr-tb" style="background-color: white !important;" class="mt-4 table table-bordered">
            <thead>
            <tr>
            <th style="background-image: linear-gradient(315deg, #002fff 0%, #0084ff 74%); color: white;" scope="col">Sr. No.</th>
            <th style="background-image: linear-gradient(315deg, #002fff 0%, #0084ff 74%); color: white;" scope="col">Name</th>
            <th style="background-image: linear-gradient(315deg, #002fff 0%, #0084ff 74%); color: white;" scope="col">Phone No.</th>
            <th style="background-image: linear-gradient(315deg, #002fff 0%, #0084ff 74%); color: white;" scope="col">PRN</th>
            <th style="background-image: linear-gradient(315deg, #002fff 0%, #0084ff 74%); color: white;" scope="col">Branch</th>
            <th style="background-image: linear-gradient(315deg, #002fff 0%, #0084ff 74%); color: white;" scope="col">Year</th>
            </tr>
        </thead>
        <tbody id="usersTable">
            
        </tbody>
        </table>
    </div>
</div>
{% elif role == "faculty" %}
<div class="container text-center mt-4">
    <h3 id="fact_txt">Users - Faculties</h3>

    <h5 class="text-success" style="text-align: right;">Total Users = <span id="total-fact"></span></h5>

    <div class="mt-3" style="display: flex; justify-content: space-between;">
        <div class="row">
            <div class="dropdown ml-3">
                <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    &#9778; Sort by
                </button>
                <div class="dropdown-menu branch-dpdn-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item fact-branch-item dropdown-item-hvr" href="#">CSE</a>
                <a class="dropdown-item fact-branch-item dropdown-item-hvr" href="#">IT</a>
                <a class="dropdown-item fact-branch-item dropdown-item-hvr" href="#">Electronics</a>
                <a class="dropdown-item fact-branch-item dropdown-item-hvr" href="#">Mechanical</a>
                <a class="dropdown-item fact-branch-item dropdown-item-hvr" href="#">Electrical</a>
                <a class="dropdown-item fact-branch-item dropdown-item-hvr" href="#">Civil</a>
                </div>
            </div>

            <div>
                <button class="btn btn-orange text-white ml-3" onclick="downloadFactPDF()">Download List <span style="font-weight: bold; transform: rotate(90deg); display: inline-block;">&#x21e5;</span></button>
            </div>
            
            <div>
                <button class="btn btn-success ml-3" id="show-all-fact">Show All Users</button>
            </div>
        </div>
        
        <div>
            <label class="sr-only" for="inlineFormInputGroup">Search</label>
            <div class="input-group mb-2">
            <div class="input-group-prepend">
                <div class="input-group-text" style="background-color: #ffc107;">&#128269;</div>
            </div>
                <input style="border: 2px solid #ffc107;" type="text" class="form-control srch-ip" id="searchInputFact" placeholder="Search by anything...">
            </div>
        </div>
    </div>

    <h3 id="fact-not-found" class="text-danger mt-3">No users found !!</h3>

    <div class="table-responsive" id="fact-tb-resp">
        <table id="fact-tb" style="background-color: white !important;" class="mt-4 table table-bordered">
            <thead>
            <tr>
            <th style="background-image: linear-gradient(315deg, #002fff 0%, #0084ff 74%); color: white;" scope="col">Sr. No.</th>
            <th style="background-image: linear-gradient(315deg, #002fff 0%, #0084ff 74%); color: white;" scope="col">Name</th>
            <th style="background-image: linear-gradient(315deg, #002fff 0%, #0084ff 74%); color: white;" scope="col">Email</th>
            <th style="background-image: linear-gradient(315deg, #002fff 0%, #0084ff 74%); color: white;" scope="col">Branch</th>
            </tr>
        </thead>
        <tbody id="factTable">
            
        </tbody>
        </table>
    </div>
</div>
{% else %}
<div class="container text-center mt-4">
    <h3 class="text-danger">Invalid!</h3>
</div>
{% endif %}

{% block my-js %}
<script>
    function decodeHtmlEntities(encodedString) {
        var textarea = document.createElement("textarea");
        textarea.innerHTML = encodedString;
        return textarea.value;
    }
    // ************ STUDENTS ************
    {% if role == "student" %}
    // Toggle Sort-by menu
    let clickCount = 0;
    $('#sort-btn').on('click', function () {
        clickCount++;

        if (clickCount % 2 === 1) {
            $('#sort-menu').addClass('show');
        } else {
            $('#sort-menu').removeClass('show');
        }
    });

    // Display branch sub-menu on hover
    let isInBranchMenu = false;
    $('#branch-txt').hover(
        function(){            
            $('#branch-menu').addClass('show');
        },
        function () {
            if(!isInBranchMenu){
                $('#branch-menu').removeClass('show');
            }
    });

    $('#branch-menu').hover(
      function () {
        isInBranchMenu = true;
      },
      function () {
        isInBranchMenu = false;
      }
    );

    // Close branch menu when item is selected
    $('.branch-item').on('click', function(){
        $("#sort-menu").removeClass("show");
        clickCount++;
    });

    // Display year sub-menu on hover
    let isInYearMenu = false;
    $('#year-txt').hover(
        function(){            
            $('#year-menu').addClass('show');
        },
        function () {
            if(!isInYearMenu){
                $('#year-menu').removeClass('show');
            }
    });

    $('#year-menu').hover(
      function () {
        isInYearMenu = true;
      },
      function () {
        isInYearMenu = false;
      }
    );

    // Close year menu when item is selected
    $('.year-item').on('click', function(){
        $("#sort-menu").removeClass("show");
        clickCount++;
    });

    // Display Branch & Year Menu
    let isInBranchAndYearMenu = false;
    $('#br-yr-txt').hover(
        function(){            
            $('#br-menu').addClass('show');
        },
        function () {
            if(!isInBranchAndYearMenu){
                $('#br-menu').removeClass('show');
            }
    });

    $('#br-menu').hover(
      function () {
        isInBranchAndYearMenu = true;
      },
      function () {
        isInBranchAndYearMenu = false;
      }
    );

    // CSE
    let isInBranchAndYear_CSE_Menu = false;
    $('#cse-txt').hover(
        function(){            
            $('#yr-menu-cse').addClass('show');
        },
        function () {
            if(!isInBranchAndYear_CSE_Menu){
                $('#yr-menu-cse').removeClass('show');
            }
    });

    $('#yr-menu-cse').hover(
      function () {
        isInBranchAndYear_CSE_Menu = true;
      },
      function () {
        isInBranchAndYear_CSE_Menu = false;
      }
    );

    // IT
    let isInBranchAndYear_IT_Menu = false;
    $('#it-txt').hover(
        function(){            
            $('#yr-menu-it').addClass('show');
        },
        function () {
            if(!isInBranchAndYear_CSE_Menu){
                $('#yr-menu-it').removeClass('show');
            }
    });

    $('#yr-menu-it').hover(
      function () {
        isInBranchAndYear_IT_Menu = true;
      },
      function () {
        isInBranchAndYear_IT_Menu = false;
      }
    );

    // Electronics
    let isInBranchAndYear_ELN_Menu = false;
    $('#eln-txt').hover(
        function(){            
            $('#yr-menu-eln').addClass('show');
        },
        function () {
            if(!isInBranchAndYear_CSE_Menu){
                $('#yr-menu-eln').removeClass('show');
            }
    });

    $('#yr-menu-eln').hover(
      function () {
        isInBranchAndYear_ELN_Menu = true;
      },
      function () {
        isInBranchAndYear_ELN_Menu = false;
      }
    );
    
    // Mech
    let isInBranchAndYear_MECH_Menu = false;
    $('#mech-txt').hover(
        function(){            
            $('#yr-menu-mech').addClass('show');
        },
        function () {
            if(!isInBranchAndYear_MECH_Menu){
                $('#yr-menu-mech').removeClass('show');
            }
    });

    $('#yr-menu-mech').hover(
      function () {
        isInBranchAndYear_MECH_Menu = true;
      },
      function () {
        isInBranchAndYear_MECH_Menu = false;
      }
    );

    // Electrical
    let isInBranchAndYear_ELEC_Menu = false;
    $('#elec-txt').hover(
        function(){            
            $('#yr-menu-elec').addClass('show');
        },
        function () {
            if(!isInBranchAndYear_ELEC_Menu){
                $('#yr-menu-elec').removeClass('show');
            }
    });

    $('#yr-menu-elec').hover(
      function () {
        isInBranchAndYear_ELEC_Menu = true;
      },
      function () {
        isInBranchAndYear_ELEC_Menu = false;
      }
    );

    // Civil
    let isInBranchAndYear_CV_Menu = false;
    $('#cv-txt').hover(
        function(){            
            $('#yr-menu-cv').addClass('show');
        },
        function () {
            if(!isInBranchAndYear_CSE_Menu){
                $('#yr-menu-cv').removeClass('show');
            }
    });

    $('#yr-menu-cv').hover(
      function () {
        isInBranchAndYear_CV_Menu = true;
      },
      function () {
        isInBranchAndYear_CV_Menu = false;
      }
    );

    // Close branch & year menu when item is selected
    $('.branch-year-item').on('click', function(){
        $("#sort-menu").removeClass("show");
        clickCount++;
    });
    
    // Display Users
    const users_from_backend = "{{users_list}}"
    const decoded_users = decodeHtmlEntities(users_from_backend)
    const users = JSON.parse(decoded_users.replace(/'/g, '"'))
    const usr_not_found_msg = $('#users-not-found');
    const usr_tb = $("#usr-tb");
    let filteredAndSortedUsers = [];

    function renderUsers(users) {
        const usersTable = $('#usersTable');
        usersTable.empty();

        usr_not_found_msg.hide();
        usr_tb.show();

        $("#total-users").text(users.length)

        if (users.length === 0) {
            usr_not_found_msg.show();
            usr_tb.hide();
        }

        users.forEach((user, idx) => {
            const row = `<tr>
                            <td style="font-weight: bold;">${idx+1}.</td>
                            <td>${user.name}</td>
                            <td>${user.phone_number}</td>
                            <td>${user.PRN}</td>
                            <td>${user.branch}</td>
                            <td>${user.year}</td>
                        </tr>`;
            usersTable.append(row);
        });
    }

    // Initial rendering of users
    function filterAndSortUsers(branch, year) {
        if (branch && year) {
            filteredAndSortedUsers = users.filter(user => user.branch === branch && user.year === year);
        }
        else if (branch){
            filteredAndSortedUsers = users.filter(user => user.branch === branch);
        }
        else if (year){
            filteredAndSortedUsers = users.filter(user => user.year === year);
        }
        else {
            filteredAndSortedUsers = [...users]; // Copy all users if no branch or year filter
        }

        renderUsers(filteredAndSortedUsers);
    }
    filterAndSortUsers('', '');
    $('#show-all-users').hide();

    // Search functionality
    $('#searchInput').on('input', function() {
        const searchTerm = $(this).val().toLowerCase();
        const filteredUsers = filteredAndSortedUsers.filter(user => {
            return Object.values(user).some(value => value.toLowerCase().includes(searchTerm));
        });
        renderUsers(filteredUsers);
    });

    // Sorting by Branch
    $('.branch-item').on('click', function() {
      const selectedBranch = $(this).text();
      $("#usr_txt").text(`Users - Students (${selectedBranch})`);
      $('#show-all-users').show();
      filterAndSortUsers(selectedBranch, '');
    });

    // Sorting by Year
    $('.year-item').on('click', function() {
      const selectedYear = $(this).text();
      $("#usr_txt").text(`Users - Students (${selectedYear})`);
      $('#show-all-users').show();
      filterAndSortUsers('', selectedYear);
    });

    // Sorting by Branch & Year
    $('.branch-year-item').on('click', function() {
      const selectedYear = $(this).text();
      const selectedBranch = $(this).closest('.dropdown-menu').prev('span').contents().filter(function(){
        return this.nodeType == 3;
      }).text().trim();

      $("#usr_txt").text(`Users - Students (${selectedBranch} - ${selectedYear})`);
      $('#show-all-users').show();
      filterAndSortUsers(selectedBranch, selectedYear);
    });

    // Show all users
    $('#show-all-users').on('click', function(){
        $("#usr_txt").text("Users - Students");
        filterAndSortUsers('', '');
        $('#show-all-users').hide();
    })

    // Download list as PDF
    function downloadStudPDF(){
        const config = {
            filename: document.getElementById("usr_txt").innerText+'.pdf',
            margin: 10, // Adds margin in mm from all(top, right, bottom, left)
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
        };

        const containerDiv = document.createElement('div');
        containerDiv.style.width = '100%';
        containerDiv.style.paddingRight = '15px';
        containerDiv.style.paddingLeft = '15px';
        containerDiv.style.marginRight = 'auto';
        containerDiv.style.marginLeft = 'auto';
        containerDiv.style.textAlign = 'center';

        // Append heading and table to the container
        containerDiv.appendChild(document.getElementById("usr_txt").cloneNode(true));
        const usr_resp = document.getElementById("usr-tb-resp").cloneNode(true);
        usr_resp.classList.remove("table-responsive")
        containerDiv.appendChild(usr_resp.querySelector("table"));
        // containerDiv.appendChild(document.getElementById("usr-tb").cloneNode(true));

        html2pdf(containerDiv, config);
    }

    // ************ FACULTIES ************
    {% elif role == "faculty" %}
    const fact_from_backend = "{{fact_list}}"
    const decoded_fact = decodeHtmlEntities(fact_from_backend)
    const fact = JSON.parse(decoded_fact.replace(/'/g, '"'))
    const fact_not_found_msg = $('#fact-not-found');
    const fact_tb = $("#fact-tb");
    let filteredandSortedFactUsers = [];

    function filterAndSortFactUsers(branch) {
        if (branch) {
            filteredAndSortedFactUsers = fact.filter(user => user.branch === branch);
        }
        else {
            filteredAndSortedFactUsers = [...fact]; // Copy all users if no branch or year filter
        }

        renderUsersFact(filteredAndSortedFactUsers);
    }

    // Display users
    function renderUsersFact(faculties) {
        const factTable = $('#factTable');
        factTable.empty();

        fact_not_found_msg.hide();
        fact_tb.show();

        $("#total-fact").text(faculties.length)

        if (faculties.length === 0) {
            fact_not_found_msg.show();
            fact_tb.hide();
        }

        faculties.forEach((user, idx) => {
            const row = `<tr>
                            <td style="font-weight: bold;">${idx+1}.</td>
                            <td>${user.name}</td>
                            <td>${user.email}</td>
                            <td>${user.branch}</td>
                        </tr>`;
            factTable.append(row);
        });
    }

    // Initial rendering of users
    filterAndSortFactUsers('');
    $('#show-all-fact').hide();

    // Search functionality
    $('#searchInputFact').on('input', function() {
        const searchFactTerm = $(this).val().toLowerCase();
        const filteredFactUsers = filteredAndSortedFactUsers.filter(user => {
            return Object.values(user).some(value => value.toLowerCase().includes(searchFactTerm));
        });
        renderUsersFact(filteredFactUsers)
    });

    // Sorting by Branch
    $('.fact-branch-item').on('click', function() {
        const selectedBr = $(this).text();
        $("#fact_txt").text(`Users - Faculties (${selectedBr})`);
        $('#show-all-fact').show();
        filterAndSortFactUsers(selectedBr);
    });

    // Show all users
    $('#show-all-fact').on('click', function(){
        $("#fact_txt").text("Users - Faculties");
        renderUsersFact(fact)
        $('#show-all-fact').hide();
    })

    // Download list as PDF
    function downloadFactPDF(){
        const config = {
            filename: document.getElementById("fact_txt").innerText+'.pdf',
            margin: 10, // Adds margin in mm from all(top, right, bottom, left)
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
        };

        const containerDiv = document.createElement('div');
        containerDiv.style.width = '100%';
        containerDiv.style.paddingRight = '15px';
        containerDiv.style.paddingLeft = '15px';
        containerDiv.style.marginRight = 'auto';
        containerDiv.style.marginLeft = 'auto';
        containerDiv.style.textAlign = 'center';

        // Append heading and table to the container
        containerDiv.appendChild(document.getElementById("fact_txt").cloneNode(true));
        const fact_resp = document.getElementById("fact-tb-resp").cloneNode(true);
        fact_resp.classList.remove("table-responsive")
        containerDiv.appendChild(fact_resp.querySelector("table"));

        html2pdf(containerDiv, config);
    }

    {% endif %}
</script>
{% endblock my-js %}

{% endblock main-content %}